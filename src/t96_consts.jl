# Fixed constants from Fortran DATA statements
const PDYN0 = 2.0
const EPS10 = 3630.7
const A_COEF = [1.162, 22.344, 18.5, 2.602, 6.903, 5.287, 0.579, 0.4462, 0.785]
const AM0 = 70.0
const S0 = 1.08
const X00 = 5.48
const DSIG = 0.005
const DELIMFX = 20.0
const DELIMFY = 10.0

# Dipole shielding coefficients
const A1_DIPSHLD = [
    0.24777, -27.003, -0.46815, 7.0637, -1.5918, -0.090317, 57.522,
    13.757, 2.01, 10.458, 4.5798, 2.1695,
]
const A2_DIPSHLD = [
    -0.65385, -18.061, -0.40457, -5.0995, 1.2846, 0.078231, 39.592,
    13.291, 1.997, 10.062, 4.514, 2.1558,
]


# Ring current parameters
const D0_RC = 2.0
const DELTADX_RC = 0.0
const XD_RC = 0.0
const XLDX_RC = 4.0
const F_RC = [569.895366, -1603.386993]
const BETA_RC = [2.722188, 3.766875]

# Tail disk parameters
const XSHIFT_TD = 4.5
const F_TD = [-745796.7338, 1176470.141, -444610.529, -57508.01028]
const BETA_TD = [7.925, 8.085, 8.47125, 27.895]

const ARC_COEF = [
    -3.087699646, 3.516259114, 18.81380577, -13.95772338, -5.497076303, 0.1712890838,
    2.392629189, -2.728020808, -14.79349936, 11.08738083, 4.388174084, 0.02492163197,
    0.7030375685, -0.7966023165, -3.835041334, 2.642228681, -0.2405352424,
    -0.7297705678, -0.3680255045, 0.1333685557, 2.795140897, -1.078379954,
    0.801402863, 0.1245825565, 0.6149982835, -0.2207267314, -4.424578723,
    1.730471572, -1.716313926, -0.2306302941, -0.2450342688, 0.08617173961,
    1.54697858, -0.6569391113, -0.6537525353, 0.2079417515, 12.75434981,
    11.37659788, 636.4346279, 1.752483754, 3.604231143, 12.83078674,
    7.412066636, 9.434625736, 676.7557193, 1.701162737, 3.580307144,
    14.64298662,
]

const ATAIL2_COEF = [
    0.8747515218, -0.9116821411, 2.209365387, -2.159059518, -7.059828867,
    5.924671028, -1.916935691, 1.996707344, -3.877101873, 3.947666061,
    11.38715899, -8.343210833, 1.194109867, -1.244316975, 3.73895491,
    -4.406522465, -20.66884863, 3.020952989, 0.2189908481, -0.09942543549,
    -0.927225562, 0.1555224669, 0.6994137909, -0.08111721003, -0.7565493881,
    0.4686588792, 4.266058082, -0.3717470262, -3.920787807, 0.0229856987,
    0.7039506341, -0.5498352719, -6.675140817, 0.8279283559, -2.234773608,
    -1.622656137, 5.187666221, 6.802472048, 39.13543412, 2.784722096,
    6.979576616, 25.7171676, 4.495005873, 8.068408272, 93.47887103,
    4.158030104, 9.313492566, 57.18240483,
]

const ATAIL3_COEF = [
    -19091.95061, -3011.613928, 20582.16203, 4242.91843, -2377.091102,
    -1504.820043, 19884.0465, 2725.150544, -21389.04845, -3990.475093,
    2401.610097, 1548.171792, -946.5493963, 490.1528941, 986.9156625,
    -489.326593, -67.99278499, 8.71117571, -45.1573426, -10.761065,
    210.7927312, 11.41764141, -178.0262808, 0.7558830028, 339.3806753,
    9.904695974, 69.50583193, -118.0271581, 22.85935896, 45.91014857,
    -425.6607164, 15.47250738, 118.2988915, 65.58594397, -201.4478068,
    -14.5706294, 19.6987797, 20.3009568, 86.4540742, 22.50403727,
    23.41617329, 48.48140573, 24.61031329, 123.5395974, 223.5367692,
    39.50824342, 65.83385762, 266.2948657,
]

const BIRK1_C1 = [
    -0.000911582, -0.00376654, -0.00727423, -0.00270084, -0.00123899, -0.00154387,
    -0.0034004, -0.0191858, -0.0518979, 0.0635061, 0.44068, -0.39657,
    0.00561238, 0.00160938, -0.00451229, -0.0025181, -0.00151599, -0.00133665,
    -0.000962089, -0.0272085, -0.0524319, 0.0717024, 0.523439, -0.405015,
    -89.5587, 23.2806,
]

const BIRK1_C2 = [
    6.04133, 0.305415, 0.606066e-2, 0.128379e-3, -0.179406e-4,
    1.41714, -27.2586, -4.28833, -1.30675, 35.5607, 8.95792, 0.961617e-3,
    -0.801477e-3, -0.782795e-3, -1.65242, -16.5242, -5.33798, 0.424878e-3,
    0.331787e-3, -0.704305e-3, 0.844342e-3, 0.953682e-4, 0.886271e-3,
    25.112, 20.9299, 5.14569, -44.167, -51.0672, -1.87725, 20.2998,
    48.7505, -2.97415, 3.35184, -54.2921, -0.838712, -10.5123, 70.7594,
    -4.94104, 0.106166e-3, 0.465791e-3, -0.193719e-3, 10.8439, -29.7968,
    8.08068, 0.463507e-3, -0.224475e-4, 0.177035e-3, -0.317581e-3,
    -0.264487e-3, 0.102075e-3, 7.7139, 10.1915, -4.99797, -23.1114,
    -29.2043, 12.2928, 10.9542, 33.6671, -9.3851, 0.174615e-3, -0.789777e-6,
    0.686047e-3, 0.460104e-4, -0.345216e-2, 0.221871e-2, 0.110078e-1,
    -0.661373e-2, 0.249201e-2, 0.343978e-1, -0.193145e-5, 0.493963e-5,
    -0.535748e-4, 0.191833e-4, -0.100496e-3, -0.210103e-3, -0.232195e-2,
    0.315335e-2, -0.13432e-1, -0.263222e-1,
]

const BIRK1_TILT = 1.00891
const BIRK1_XCENTRE = (2.28397, -5.60831)
const BIRK1_RADIUS = (1.86106, 7.83281)
const BIRK1_DIPX = 1.12541
const BIRK1_DIPY = 0.945719
const BIRK1_DX = -0.16
const BIRK1_SCALEIN = 0.08
const BIRK1_SCALEOUT = 0.4
const BIRK1_XX1 = [-11.0, -7.0, -7.0, -3.0, -3.0, 1.0, 1.0, 1.0, 5.0, 5.0, 9.0, 9.0]
const BIRK1_YY1 = [2.0, 0.0, 4.0, 2.0, 6.0, 0.0, 4.0, 8.0, 2.0, 6.0, 0.0, 4.0]
const BIRK1_XX2 = [-10.0, -7.0, -4.0, -4.0, 0.0, 4.0, 4.0, 7.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0]
const BIRK1_YY2 = [3.0, 6.0, 3.0, 9.0, 6.0, 3.0, 9.0, 6.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0]
const BIRK1_ZZ2 = [20.0, 20.0, 4.0, 20.0, 4.0, 4.0, 20.0, 20.0, 20.0, 2.0, 3.0, 4.5, 7.0, 10.0]

const BIRK1_SHLD = [
    1.174198045, -1.463820502, 4.840161537, -3.674506864, 82.18368896,
    -94.94071588, -4122.331796, 4670.278676, -21.54975037, 26.72661293,
    -72.81365728, 44.09887902, 40.08073706, -51.2356351, 1955.348537,
    -1940.97155, 794.0496433, -982.2441344, 1889.837171, -558.9779727,
    -1260.543238, 1260.063802, -293.5942373, 344.7250789, -773.7002492,
    957.0094135, -1824.143669, 520.7994379, 1192.484774, -1192.184565,
    89.15537624, -98.52042999, -0.08168777675, 0.04255969908, 0.3155237661,
    -0.3841755213, 2.494553332, -0.06571440817, -2.76566131, 0.4331001908,
    0.1099181537, -0.0615412698, -0.325864926, 0.6698439193, -5.542735524,
    0.1604203535, 5.854456934, -0.8323632049, 3.732608869, -3.130002153,
    107.0972607, -32.28483411, -115.2389298, 54.4506436, -0.582685332,
    -3.582482231, -4.046544561, 3.311978102, -104.0839563, 30.26401293,
    97.29109008, -50.62370872, -296.3734955, 127.7872523, 5.303648988,
    10.40368955, 69.65230348, 466.5099509, 1.645049286, 3.82583819,
    11.66675599, 558.9781177, 1.826531343, 2.066018073, 25.40971369,
    990.2795225, 2.319489258, 4.555148484, 9.691185703, 591.8280358,
]

const BIRK2_SHL = [
    -111.6371348, 124.5402702, 110.3735178, -122.0095905, 111.9448247,
    -129.1957743, -110.7586562, 126.5649012, -0.7865034384, -0.2483462721,
    0.8026023894, 0.2531397188, 10.72890902, 0.8483902118, -10.96884315,
    -0.8583297219, 13.85650567, 14.905545, 10.21914434, 10.09021632,
    6.34038246, 14.40432686, 12.71023437, 12.83966657,
]

const R2_OUTER_PL = [-34.105, -2.00019, 628.639, 73.4847, 12.5162]
const R2_OUTER_PN = [
    0.55, 0.694, 0.0031, 1.55, 2.8, 0.1375, -0.7, 0.2, 0.9625, -2.994, 2.925,
    -1.775, 4.3, -0.275, 2.7, 0.4312, 1.55,
]

const R2_INNER_PL = [154.185, -2.12446, 0.0601735, -0.00153954, 0.0000355077, 29.9996, 262.886, 99.9132]
const R2_INNER_PN = [-8.1902, 6.5239, 5.504, 7.7815, 0.8573, 3.0986, 0.0774, -0.038]

const R2_SHEET_PNONX = [-19.0969, -9.28828, -0.129687, 5.58594, 22.5055, 0.048375, 0.0396953, 0.0579023]
const R2_SHEET_PNONY = [-13.675, -6.70625, 2.31875, 11.4062, 20.4562, 0.047875, 0.036375, 0.05675]
const R2_SHEET_PNONZ = [-16.7125, -16.4625, -0.1625, 5.1, 23.7125, 0.0355625, 0.031875, 0.053875]

const R2_SHEET_A = [
    8.0719, -7.39582, -7.62341, 0.684671, -13.5672, 11.6681, 13.1154, -0.890217,
    7.78726, -5.38346, -8.08738, 0.609385, -2.7041, 3.53741, 3.15549, -1.11069,
    -8.47555, 0.278122, 2.73514, 4.55625, 13.1134, 1.15848, -3.52648, -8.24698,
    -6.8571, -2.81369, 2.03795, 4.64383, 2.49309, -1.22041, -1.67432,
    -0.422526, -5.39796, 7.10326, 5.5373, -13.1918, 4.67853, -7.60329,
    -2.53066, 7.76338, 5.60165, 5.34816, -4.56441, 7.05976, -2.62723,
    -0.529078, 1.42019, -2.93919, 55.6338, -1.55181, 39.8311, -80.6561,
    -46.9655, 32.8925, -6.32296, 19.7841, 124.731, 10.4347, -30.7581,
    102.68, -47.4037, -3.31278, 9.37141, -50.0268, -533.319, 110.426,
    1000.2, -1051.4, 1619.48, 589.855, -1462.73, 1087.1, -1994.73,
    -1654.12, 1263.33, -260.21, 1424.84, 1255.71, -956.733, 219.946,
]

const R2_SHEET_B = [
    -9.08427, 10.6777, 10.3288, -0.969987, 6.45257, -8.42508, -7.97464,
    1.41996, -1.9249, 3.93575, 2.83283, -1.48621, 0.244033, -0.757941,
    -0.386557, 0.344566, 9.56674, -2.5365, -3.32916, -5.86712, -6.19625,
    1.83879, 2.52772, 4.34417, 1.87268, -2.13213, -1.69134, -0.176379,
    -0.261359, 0.566419, 0.3138, -0.134699, -3.83086, -8.4154, 4.77005,
    -9.31479, 37.5715, 19.3992, -17.9582, 36.4604, -14.9993, -3.1442,
    6.17409, -15.5519, 2.28621, -0.00891549, -0.462912, 2.47314, 41.7555,
    208.614, -45.7861, -77.8687, 239.357, -67.9226, 66.8743, 238.534,
    -112.136, 16.2069, -40.4706, -134.328, 21.56, -0.201725, 2.21, 32.5855,
    -108.217, -1005.98, 585.753, 323.668, -817.056, 235.75, -560.965,
    -576.892, 684.193, 85.0275, 168.394, 477.776, -289.253, -123.216,
    75.6501, -178.605,
]

const R2_SHEET_C = [
    1167.61, -917.782, -1253.2, -274.128, -1538.75, 1257.62, 1745.07, 113.479,
    393.326, -426.858, -641.1, 190.833, -29.9435, -1.04881, 117.125, -25.7663,
    -1168.16, 910.247, 1239.31, 289.515, 1540.56, -1248.29, -1727.61, -131.785,
    -394.577, 426.163, 637.422, -187.965, 30.0348, 0.221898, -116.68, 26.0291,
    12.6804, 4.84091, 1.18166, -2.75946, -17.9822, -6.80357, -1.47134, 3.02266,
    4.79648, 0.665255, -0.256229, -0.0857282, -0.588997, 0.0634812, 0.164303,
    -0.15285, 22.2524, -22.4376, -3.85595, 6.07625, -105.959, -41.6698,
    0.378615, 1.55958, 44.3981, 18.8521, 3.19466, 5.89142, -8.63227,
    -2.36418, -1.027, -2.31515, 1035.38, 2040.66, -131.881, -744.533,
    -3274.93, -4845.61, 482.438, 1567.43, 1354.02, 2040.47, -151.653, -845.012,
    -111.723, -265.343, -26.1171, 216.632,
]

const INTERCON_A = [
    -8.411078731, 5932254.951, -9073284.93, -11.68794634, 6027598.824,
    -9218378.368, -6.508798398, -11824.42793, 18015.66212, 7.99754043,
    13.9669886, 90.24475036, 16.75728834, 1015.645781, 1553.493216,
]
